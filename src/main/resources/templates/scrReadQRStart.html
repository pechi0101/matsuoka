<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<!--リセットＣＳＳ-->
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/destyle.css@4.0.0/destyle.min.css">
<!--Font Awesome(無償版)のアイコン-->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
<!--オリジナルＣＳＳ(常に最新のcssを読込むよう工夫)-->
<script type="text/JavaScript">
<!--
   document.write('<link href="/matsuoka/css/style.css?ver='+ new Date().getTime() +'" rel="stylesheet" type="text/css">');
//-->
</script>

<!-- 
	サーバでデプロイする場合、CSS,JavaScript,画像などはドキュメントルート（※）内に配置すること
	※例
	  ＣＳＳ    ：/var/www/html/css
	  JavaScript：/var/www/html/js
	  画像      ：/var/www/html/images
 -->


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<!-- jQueryがレスポンシブに対応するため必要になるコード...らしい-->
<!-- 参考：https://job-support.ne.jp/blog/javascript/howto-jquery-->
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- ▽や△のアイコンをCSSで使うためにリンクを貼る -->
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">

<!-- ローカルストレージをクリアしてTopページにリダイレクトするJavaScript -->
<script type="text/javascript">
	function clearLocalStorageAndRedirect() {
		// ローカルストレージをクリア
		localStorage.clear();
		// 新しいページにリダイレクト
		window.location.href = "/matsuoka/indexQR";
	}
</script>
</head>
<body>

<header class="ymd-header">
	ＱＲコード読取起動
</header>
<div class="ymd-navigation">
	<div style="width: 50%;"><a href="javascript:void(0);" onclick="clearLocalStorageAndRedirect()">&lt;&lt; 作業者を変更</a></div>
	<div style="width: 50%;"><a th:href="@{/matsuoka/indexQR}">&lt;&lt; 最初に戻る</a></div>
</div>


<center>
<div class="ymd-base-container">


	<br>
	
	<!--  -->
	<form name="readQRStartForm" th:action="@{/matsuoka/TransitionReadQR}" th:object="${formReadQRStart}" th:method="post" style="width: 100%;">
		
		<!-- 非表示項目エリア -->
		<input type="hidden" id="loginEmployeeId"     style="width: 100%;" th:field="*{loginEmployeeId}" />
		<input type="hidden" id="loginEmployeeName"   style="width: 100%;" th:field="*{loginEmployeeName}" />
		<input type="hidden" id="selectedDeviceLabel" style="width: 100%;" th:field="*{selectedDeviceLabel}" />
		
		<!-- ユーザ表示エリア -->
		<div class="ymd-login-username" style="width: 100%;">
			作業者名：<p th:text="*{loginEmployeeName}"></p>
		</div>
		<div class="ymd-login-user-status" style="width: 100%;">
			勤怠状況：<p th:text="*{strClockInOutStatusMSG}"></p>
		</div>
		<div class="ymd-login-user-status" style="width: 100%;" id="dispWorkStatusList">
			作業状況：<p th:text="*{strWorkStatusMSG}"></p>
		</div>
		
		<!-- メッセージ表示エリア -->
		<div class="ymd-container" id="result-message-area" style="width: 100%; display: block;border: 1px;border-style: solid; border-color: gray;">
			<span>【処理結果メッセージ】</span>
			<br>
			<textarea
				id="message"
				th:field="*{message}"
				readonly
				style="width: 100%; height: 100px;"
			/></textarea>
		</div>
		
		
		
		<!-- ＱＲリーダ起動ボタン表示エリア -->
		<br>
		<div class="ymd-container" style="width: 100%;">
			ＱＲコードの読み取りを開始する場合、下のボタンを押してください。<br>
		</div>
		<br>
		<div class="ymd-button">
			<a href="javascript:readQRStartForm.submit();">ＱＲコード読取開始</a>
		</div>
		
		
		<br>
		<div class="ymd-button">
			<a name="dispWorkStatusButton">作業状況表示</a>
		</div>
		<br>
		
	
	</form>
	
	
	
</div>

<!--オリジナルJavaScript(常に最新を読込むよう工夫)-->
<script type="text/JavaScript">
<!--
	 document.write('<script src="/matsuoka/js/scrReadQRStart.js?ver='+ new Date().getTime() +'"></script>');
	
	// ローカルストレージに画面表示「不許可」の状態を書き込む 
	//
	// ■ブラウザバック防止施策
	// ------------------------------------------------
	// 【やりたいコト】
	// 以下画面②へブラウザバックで戻ってこれないようにする
	// ①データを書き込む画面の遷移元画面
	// ②データを書き込む画面
	// 
	// 【施策】
	// indexQR画面表示時：ローカルストレージを「不許可」にする
	// 画面①→②遷移時：ローカルストレージを「許可」にする
	// 画面②表示前：ローカルストレージが「許可」  である場合、画面表示処理を行い、  表示処理終了後にローカルストレージを「不許可」に戻す
	// 画面②表示前：ローカルストレージが「不許可」である場合、画面表示処理を行わず、indexQR画面に強制的に遷移させられる
	//          ▼
	// 画面②のボタン押下などでデータを書き込んだあと別画面に遷移
	// ブラウザバックで画面②に戻った際、ローカルストレージが「不許可」になっているためindexQR画面に強制的に遷移する 
	// ------------------------------------------------
	// 
	// ■ローカルストレージの設定例(true：許可、false：不許可)
	// localStorage.setItem("localStorage_IsDispScreen"  ,"false");
	localStorage.setItem("localStorage_IsDispScreen"  ,"false");

//-->
</script>

</body>
</html>